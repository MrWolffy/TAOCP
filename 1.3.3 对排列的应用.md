## 1.3.3 对排列的应用

- 记号

  - 重新安排一个排列：

  $$
  \left( \begin{matrix}
  	a\ b\ c\ d\ e\ f \\
  	c\ d\ f\ b\ e\ a
  \end{matrix} \right)
  $$

  - 循环记号：

  $$
  (a\ c\ f)\ (b\ d)
  $$

  - 所有的元素都不动的排列（恒等排列）用$(\ )$来表示。
  - 性质：循环记号能够表示任意一个排列。

- 排列的乘积：在一个排列之后再次应用另一个排列

  - 排列的乘法可以直接地借助循环记号来进行。

> 算法A（以循环形式进行排列乘法）
>
> A1. [第1遍] 对所有左圆括弧加标记，并对每一个右圆括弧，用与之配对的左圆括弧后面等待输入符号的加标记副本替换。
>
> A2. [开括弧] 从左到右地查找，找出输入中头一个未曾标记的元素。（如果所有元素都已经加了标记，则算法结束。）置START等于这个元素，输出一个左圆括弧，输出此元素并标记它）。
>
> A3. [置CURRENT] 置CURRENT等于算式的下一个元素。
>
> A4. [扫描算式] 向右进行直到或者达到算式的末尾，或者找到一个等于CURRENT的元素。在后一种情况下，对它加标记并返回步骤A3。
>
> A5. [CURRENT = START?] 如果CURRENT ≠ START，输出CURRENT并返回到步骤A4，再次由算式左边开始（从而继续扩展输出中的一个循环）。
>
> A6. [闭括弧] （在输出中已经求出一个完整的循环。）输出一个右圆括弧，并返回步骤A2。

> 算法B（循环形式的排列乘法）
>
> B1. [初始化] 对于$1 \le k \le n$，置$T[k] \leftarrow k$。而且，准备从右到左地扫描输入。
>
> B2. [下个元素] 考察输入的下一元素（从右至左）。如果输入已经穷尽，则算法结束。如果元素是“)”，置$Z \leftarrow 0$并重复步骤B2；如果它是“(”，转到B4。否则对于某个i，元素是$x_i$，转到B3。
>
> B3. [改变$T[i]$] 交换$Z \leftrightarrow T[i]$。如果这使$T[i] = 0$，置$j \leftarrow i$。返回步骤B2。
>
> B4. [改变$T[j]$] 置$T[j] \leftarrow Z$。返回步骤B2。

- 求逆：一个排列$\pi$的逆$\pi^-$是一个撤销$\pi$的结果的重新安排。$\pi \pi^-$和$\pi^- \pi$等于恒等排列。

> 算法I（就地求逆） 将$\{1, 2, \dots, n\}$的一个排列$X[1] X[2] \cdots X[n]$用它的逆代替。
>
> I1. [初始化] 置$m \leftarrow n$，$j \leftarrow -1$。
>
> I2. [下个元素] 置$i \leftarrow X[m]$。如果$i < 0$，转到步骤I5（此元素已经处理过）。
>
> I3. [对一个元素求逆] （这时$j < 0$和$i = X[m]$。如果m不是它的循环的最大元素，则原来的排列有$X[-j] = m$。）置$X[m] \leftarrow j, j \leftarrow -m, m \leftarrow i, i \leftarrow X[m]$。
>
> I4. [循环结束了吗?] 如果$i > 0$，转回I3（循环还未结束）；否则置$i \leftarrow j$。（在后一情况下，原来的排列有$X[-j] = m$且m是在它的循环中之最大者。）
>
> I5. [存储最后的值] 置$X[m] \leftarrow -i$。（原来$X[-i]$等于m。）
>
> I6. [对m循环] m减1。如果$m > 0$，转回I2；否则算法结束。

> 算法J（就地求逆）
>
> J1. [全部取负] 对于$1 \le k \le n$，置$X[k] \leftarrow -X[k]$。而且置$m \leftarrow n$。
>
> J2. [初始化j] 置$j \leftarrow m$。
>
> J3. [求负的项] 置$i \leftarrow X[j]$。如果$i > 0$，置$j \leftarrow i$并重复这一步骤。
>
> J4. [求逆] 置$X[j] \leftarrow X[-i]$，$X[-i] \leftarrow m$。
>
> J5. [对m循环] m减1；如果$m > 0$，转回J2。否则算法结束。

​	算法J的平均运行时间基本上同$n\ln{n}$成比例，而算法I的平均运行时间实际上同n成比例。

- 范式

  - 定义

    - 直接写出所有的单元素循环。
    - 在每一个循环内，首先写出最小的元素。
    - 以循环中头一个元素的递减顺序来对诸循环排序。

  - 性质

    - 平均说来，n个元素的排列共有多少个循环

    $$
    \min{1}, \mathrm{ave}\ H_n, \max{n}, \mathrm{dev}\sqrt{H_n - H_n^{(2)}}
    $$

    - 一个循环的平均长度：$n/H_n$
    - 单元素循环的平均个数

    $$
    \min{0}, \mathrm{ave}\ 1, \max{n}, \mathrm{dev}\ 1
    $$

### 习题

> 1

$$
\left( \begin{matrix}
	0\ 1\ 2\ 3\ 4\ 5\ 6 \\
	0\ 2\ 4\ 6\ 1\ 3\ 5
\end{matrix} \right)
$$

循环形式为
$$
(1\ 2\ 4)\ (3\ 6\ 5)
$$

> 2

$$
a \leftrightarrow c, a \leftrightarrow f, b \leftrightarrow d
$$

> 3

$$
\left( \begin{matrix}
	a\ b\ c\ d\ e\ f \\
	d\ b\ f\ c\ a\ e
\end{matrix} \right)
$$

> 4

$$
(a\ d\ c\ f\ e)\ (b)
$$

> 5

12种。

> 7

X = 2, Y = 29, M = 5, N = 7, U = 3, V = 1

时间为2161u。

> 8

可以。将记住排列的逆。

> 9

不同。

> 11

倒过来写。

> 15

单个对象的排列。

> 16

(4) (2 3) (1)

4 2 3 1

(3) (2) (1 4)

3 2 1 4

(4) (2)  (1 3)

4 2 1 3

(2) (1 4 3)

2 1 4 3

(3 4) (1 2)

3 4 1 2

(2 4) (1 3)

2 4 1 3

(1 2 4 3)

1 2 4 3

(3 4) (2) (1)

3 4 2 1

(1 3 2 4)

1 3 2 4

> 20

$$
(\alpha_1 + \alpha_2 + \cdots)! \times 1^{\alpha_1} \times 2^{\alpha_2} \times \cdots
$$



